{"ast":null,"code":"import _objectSpread from\"/home/runner/work/gitgame/gitgame/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/runner/work/gitgame/gitgame/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState,useRef,useEffect}from\"react\";import\"./Editor.css\";import darkTheme from\"./EditorDarkTheme\";import lightTheme from\"prism-react-renderer/themes/github\";import\"./Editor.css\";import{commentTypeToEmoji}from\"../../Interface\";import ThemeContext,{isDark}from\"../../context/ThemeContext\";import{Pre,Line,LineNo,LineContent}from\"./Styles\";import Highlight,{defaultProps}from\"prism-react-renderer\";import useLineSelection from\"./hooks/lineSelection/UseLineSelection\";import CommentCreationMenu from\"./CommentCreationMenu\";import EmojiShower from\"./animation/EmojiAnimation\";import CommentHighlightContext from\"../../context/CommentHighlightContext\";import{computeLazyScrollYAxisOptions,getViewportBounds,mergeViewportBounds}from\"./Util\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";// todo: fill this out for supported languages\nvar prismExtensionMapping={dart:\"clike\",java:\"clike\",py:\"python\",swift:\"typescript\"// dummy value to get prism to highlight swift code\n};function getPrismExtension(extension){if(extension in prismExtensionMapping){return prismExtensionMapping[extension];}return extension;}function Editor(_ref){var code=_ref.code,newComments=_ref.newComments,onNewCommentAck=_ref.onNewCommentAck,addComment=_ref.addComment;var _useContext=useContext(CommentHighlightContext),commentHighlight=_useContext.commentHighlight,dehighlight=_useContext.dehighlight;var _useContext2=useContext(ThemeContext),theme=_useContext2.theme;var _useLineSelection=useLineSelection(),selectedLines=_useLineSelection.selectedLines,clearLineSelection=_useLineSelection.clearLineSelection,handleLineToggle=_useLineSelection.handleLineToggle,isLineSelected=_useLineSelection.isLineSelected;// todo(ramko9999): abstract the context menu state to a hook\nvar _useState=useState({shouldOpen:false,posX:-1,posY:-1}),_useState2=_slicedToArray(_useState,2),contextMenuProps=_useState2[0],setContextMenuProps=_useState2[1];var cancelCommentCreation=function cancelCommentCreation(){closeContextMenu();clearLineSelection();};useEffect(function(){var _codeRef$current;cancelCommentCreation();dehighlight();(_codeRef$current=codeRef.current)===null||_codeRef$current===void 0?void 0:_codeRef$current.scroll(0,0);},[code.id]);useEffect(function(){if(commentHighlight){scrollToHighlight();cancelCommentCreation();}},[commentHighlight]);var closeContextMenu=function closeContextMenu(){setContextMenuProps(function(props){return _objectSpread(_objectSpread({},props),{},{shouldOpen:false});});};var createComment=function createComment(comment){if(addComment!==undefined){addComment(comment);}cancelCommentCreation();};var codeRef=useRef(null);var scrollToHighlight=function scrollToHighlight(){var _codeRef$current2;var lineStart=document.getElementById(\"\".concat(commentHighlight===null||commentHighlight===void 0?void 0:commentHighlight.comment.line_start,\"-content\"));var lineEnd=document.getElementById(\"\".concat(commentHighlight===null||commentHighlight===void 0?void 0:commentHighlight.comment.line_end,\"-content\"));var startBounds=getViewportBounds(lineStart);var codeBounds=getViewportBounds(codeRef.current);var highlightBounds=mergeViewportBounds(startBounds,getViewportBounds(lineEnd));var scrollToOptions=computeLazyScrollYAxisOptions(codeBounds,highlightBounds,startBounds.height);(_codeRef$current2=codeRef.current)===null||_codeRef$current2===void 0?void 0:_codeRef$current2.scrollBy(scrollToOptions);};var isHighlightLine=function isHighlightLine(lineNumber){return commentHighlight&&commentHighlight.comment.line_start<=lineNumber&&lineNumber<=commentHighlight.comment.line_end;};var computeBoundingBox=function computeBoundingBox(lineStartNo,lineEndNo){var lineStart=document.getElementById(\"\".concat(lineStartNo,\"-content\"));var lineEnd=document.getElementById(\"\".concat(lineEndNo,\"-content\"));return mergeViewportBounds(getViewportBounds(lineStart),getViewportBounds(lineEnd));};var getShowersProps=function getShowersProps(){return newComments.map(function(comment){var id=comment.id,line_end=comment.line_end,line_start=comment.line_start,type=comment.type;var box=computeBoundingBox(line_start,line_end);return{comment:comment,id:id,box:box,emoji:commentTypeToEmoji(type)};});};return/*#__PURE__*/_jsxs(\"div\",{className:\"code-container\",onClick:function onClick(){closeContextMenu();if(commentHighlight){dehighlight();}},children:[/*#__PURE__*/_jsx(\"div\",{className:\"editor-context-menu\",onClick:function onClick(event){event.stopPropagation();console.log(\"Editor Context Menu Triggered\");},style:{top:contextMenuProps.posY,left:contextMenuProps.posX},children:/*#__PURE__*/_jsx(CommentCreationMenu,{open:contextMenuProps.shouldOpen,onCancel:cancelCommentCreation,onSubmit:createComment,lines:selectedLines})}),/*#__PURE__*/_jsx(Highlight,_objectSpread(_objectSpread({},defaultProps),{},{theme:isDark(theme)?darkTheme:lightTheme,code:code.content,language:getPrismExtension(code.file_extension),children:function children(_ref2){var className=_ref2.className,style=_ref2.style,tokens=_ref2.tokens,getLineProps=_ref2.getLineProps,getTokenProps=_ref2.getTokenProps;return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Pre,{ref:codeRef,children:[getShowersProps().map(function(props){return/*#__PURE__*/_jsx(EmojiShower,{emoji:props.emoji,zone:props.box,count:30,onFinish:function onFinish(){//todo(Ramko9999): Understand why onFinish can be triggered even after the next source code arrives and the Editor is re-rendered with\n//that next source code\nonNewCommentAck(props.comment.id);}},props.id);}),tokens.map(function(line,lineIndex){var lineContentClass;if(isLineSelected(lineIndex)){lineContentClass=\"selected-line\";}if(isHighlightLine(lineIndex)){lineContentClass=\"comment-highlighted-line\";}return/*#__PURE__*/_jsxs(Line,_objectSpread(_objectSpread({},getLineProps({line:line,key:lineIndex})),{},{children:[/*#__PURE__*/_jsx(LineNo,{onClick:function onClick(e){handleLineToggle(e,lineIndex);},children:lineIndex+1}),/*#__PURE__*/_jsx(LineContent,{id:\"\".concat(lineIndex,\"-content\"),className:lineContentClass,onContextMenu:function onContextMenu(event){if(isLineSelected(lineIndex)){event.preventDefault();setContextMenuProps({shouldOpen:true,posX:event.pageX,posY:event.pageY});}},children:line.map(function(token,tokenIndex){return/*#__PURE__*/_jsx(\"span\",_objectSpread({},getTokenProps({token:token,key:tokenIndex})),tokenIndex);})})]}),lineIndex);})]})});}}))]});}export default Editor;","map":{"version":3,"names":["useContext","useState","useRef","useEffect","darkTheme","lightTheme","commentTypeToEmoji","ThemeContext","isDark","Pre","Line","LineNo","LineContent","Highlight","defaultProps","useLineSelection","CommentCreationMenu","EmojiShower","CommentHighlightContext","computeLazyScrollYAxisOptions","getViewportBounds","mergeViewportBounds","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","prismExtensionMapping","dart","java","py","swift","getPrismExtension","extension","Editor","_ref","code","newComments","onNewCommentAck","addComment","_useContext","commentHighlight","dehighlight","_useContext2","theme","_useLineSelection","selectedLines","clearLineSelection","handleLineToggle","isLineSelected","_useState","shouldOpen","posX","posY","_useState2","_slicedToArray","contextMenuProps","setContextMenuProps","cancelCommentCreation","closeContextMenu","_codeRef$current","codeRef","current","scroll","id","scrollToHighlight","props","_objectSpread","createComment","comment","undefined","_codeRef$current2","lineStart","document","getElementById","concat","line_start","lineEnd","line_end","startBounds","codeBounds","highlightBounds","scrollToOptions","height","scrollBy","isHighlightLine","lineNumber","computeBoundingBox","lineStartNo","lineEndNo","getShowersProps","map","type","box","emoji","className","onClick","children","event","stopPropagation","console","log","style","top","left","open","onCancel","onSubmit","lines","content","language","file_extension","_ref2","tokens","getLineProps","getTokenProps","ref","zone","count","onFinish","line","lineIndex","lineContentClass","key","e","onContextMenu","preventDefault","pageX","pageY","token","tokenIndex"],"sources":["/home/runner/work/gitgame/gitgame/client/src/components/editor/Editor.tsx"],"sourcesContent":["import { useContext, useState, useRef, useEffect } from \"react\";\nimport \"./Editor.css\";\nimport darkTheme from \"./EditorDarkTheme\";\nimport lightTheme from \"prism-react-renderer/themes/github\";\nimport \"./Editor.css\";\nimport {\n  Code,\n  Lines,\n  AddComment,\n  commentTypeToEmoji,\n  Comment,\n} from \"../../Interface\";\nimport ThemeContext, { isDark } from \"../../context/ThemeContext\";\nimport { Pre, Line, LineNo, LineContent } from \"./Styles\";\nimport Highlight, { defaultProps, Language } from \"prism-react-renderer\";\nimport useLineSelection from \"./hooks/lineSelection/UseLineSelection\";\nimport CommentCreationMenu from \"./CommentCreationMenu\";\nimport EmojiShower from \"./animation/EmojiAnimation\";\nimport CommentHighlightContext from \"../../context/CommentHighlightContext\";\nimport {\n  computeLazyScrollYAxisOptions,\n  getViewportBounds,\n  mergeViewportBounds,\n} from \"./Util\";\n\ninterface EditorProps {\n  code: Code;\n  newComments: Comment[];\n  onNewCommentAck: (comment_id: string) => void;\n  addComment?: (comment: AddComment) => void;\n}\n\ninterface EditorContextMenu {\n  shouldOpen: boolean;\n  posX: number;\n  posY: number;\n}\n\n// todo: fill this out for supported languages\nconst prismExtensionMapping: { [index: string]: string } = {\n  dart: \"clike\",\n  java: \"clike\",\n  py: \"python\",\n  swift: \"typescript\", // dummy value to get prism to highlight swift code\n};\n\nfunction getPrismExtension(extension: string): Language {\n  if (extension in prismExtensionMapping) {\n    return prismExtensionMapping[extension] as Language;\n  }\n  return extension as Language;\n}\n\nfunction Editor({\n  code,\n  newComments,\n  onNewCommentAck,\n  addComment,\n}: EditorProps) {\n  const { commentHighlight, dehighlight } = useContext(CommentHighlightContext);\n  const { theme } = useContext(ThemeContext);\n  const {\n    selectedLines,\n    clearLineSelection,\n    handleLineToggle,\n    isLineSelected,\n  } = useLineSelection();\n\n  // todo(ramko9999): abstract the context menu state to a hook\n  const [contextMenuProps, setContextMenuProps] = useState<EditorContextMenu>({\n    shouldOpen: false,\n    posX: -1,\n    posY: -1,\n  });\n\n  const cancelCommentCreation = () => {\n    closeContextMenu();\n    clearLineSelection();\n  };\n\n  useEffect(() => {\n    cancelCommentCreation();\n    dehighlight();\n    codeRef.current?.scroll(0, 0);\n  }, [code.id]);\n\n  useEffect(() => {\n    if (commentHighlight) {\n      scrollToHighlight();\n      cancelCommentCreation();\n    }\n  }, [commentHighlight]);\n\n  const closeContextMenu = () => {\n    setContextMenuProps((props) => {\n      return {\n        ...props,\n        shouldOpen: false,\n      };\n    });\n  };\n\n  const createComment = (comment: AddComment) => {\n    if (addComment !== undefined) {\n      addComment(comment);\n    }\n    cancelCommentCreation();\n  };\n\n  const codeRef = useRef<HTMLPreElement | null>(null);\n\n  const scrollToHighlight = () => {\n    const lineStart = document.getElementById(\n      `${commentHighlight?.comment.line_start}-content`\n    );\n    const lineEnd = document.getElementById(\n      `${commentHighlight?.comment.line_end}-content`\n    );\n\n    const startBounds = getViewportBounds(lineStart as HTMLElement);\n    const codeBounds = getViewportBounds(codeRef.current as HTMLElement);\n\n    const highlightBounds = mergeViewportBounds(\n      startBounds,\n      getViewportBounds(lineEnd as HTMLElement)\n    );\n\n    const scrollToOptions = computeLazyScrollYAxisOptions(\n      codeBounds,\n      highlightBounds,\n      startBounds.height\n    );\n    codeRef.current?.scrollBy(scrollToOptions);\n  };\n\n  const isHighlightLine = (lineNumber: number) => {\n    return (\n      commentHighlight &&\n      commentHighlight.comment.line_start <= lineNumber &&\n      lineNumber <= commentHighlight.comment.line_end\n    );\n  };\n\n  const computeBoundingBox = (lineStartNo: number, lineEndNo: number) => {\n    const lineStart = document.getElementById(`${lineStartNo}-content`);\n    const lineEnd = document.getElementById(`${lineEndNo}-content`);\n\n    return mergeViewportBounds(\n      getViewportBounds(lineStart as HTMLElement),\n      getViewportBounds(lineEnd as HTMLElement)\n    );\n  };\n\n  const getShowersProps = () => {\n    return newComments.map((comment) => {\n      const { id, line_end, line_start, type } = comment;\n      const box = computeBoundingBox(line_start, line_end);\n      return {\n        comment,\n        id,\n        box,\n        emoji: commentTypeToEmoji(type),\n      };\n    });\n  };\n\n  return (\n    <div\n      className=\"code-container\"\n      onClick={() => {\n        closeContextMenu();\n        if (commentHighlight) {\n          dehighlight();\n        }\n      }}\n    >\n      <div\n        className=\"editor-context-menu\"\n        onClick={(event: React.MouseEvent) => {\n          event.stopPropagation();\n          console.log(\"Editor Context Menu Triggered\");\n        }}\n        style={{ top: contextMenuProps.posY, left: contextMenuProps.posX }}\n      >\n        <CommentCreationMenu\n          open={contextMenuProps.shouldOpen}\n          onCancel={cancelCommentCreation}\n          onSubmit={createComment}\n          lines={selectedLines as Lines}\n        />\n      </div>\n      <Highlight\n        {...defaultProps}\n        theme={isDark(theme) ? darkTheme : lightTheme}\n        code={code.content}\n        language={getPrismExtension(code.file_extension)}\n      >\n        {({ className, style, tokens, getLineProps, getTokenProps }) => {\n          return (\n            <>\n              <Pre ref={codeRef}>\n                {getShowersProps().map((props) => {\n                  return (\n                    <EmojiShower\n                      key={props.id}\n                      emoji={props.emoji}\n                      zone={props.box}\n                      count={30}\n                      onFinish={() => {\n                        //todo(Ramko9999): Understand why onFinish can be triggered even after the next source code arrives and the Editor is re-rendered with\n                        //that next source code\n                        onNewCommentAck(props.comment.id);\n                      }}\n                    />\n                  );\n                })}\n                {tokens.map((line, lineIndex) => {\n                  let lineContentClass;\n                  if (isLineSelected(lineIndex)) {\n                    lineContentClass = \"selected-line\";\n                  }\n                  if (isHighlightLine(lineIndex)) {\n                    lineContentClass = \"comment-highlighted-line\";\n                  }\n\n                  return (\n                    <Line\n                      key={lineIndex}\n                      {...getLineProps({ line, key: lineIndex })}\n                    >\n                      <LineNo\n                        onClick={(e) => {\n                          handleLineToggle(e, lineIndex);\n                        }}\n                      >\n                        {lineIndex + 1}\n                      </LineNo>\n                      <LineContent\n                        id={`${lineIndex}-content`}\n                        className={lineContentClass}\n                        onContextMenu={(event: React.MouseEvent) => {\n                          if (isLineSelected(lineIndex)) {\n                            event.preventDefault();\n                            setContextMenuProps({\n                              shouldOpen: true,\n                              posX: event.pageX,\n                              posY: event.pageY,\n                            });\n                          }\n                        }}\n                      >\n                        {line.map((token, tokenIndex) => (\n                          <span\n                            key={tokenIndex}\n                            {...getTokenProps({ token, key: tokenIndex })}\n                          />\n                        ))}\n                      </LineContent>\n                    </Line>\n                  );\n                })}\n              </Pre>\n            </>\n          );\n        }}\n      </Highlight>\n    </div>\n  );\n}\n\nexport default Editor;\n"],"mappings":"2PAAA,OAASA,UAAU,CAAEC,QAAQ,CAAEC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CAC/D,MAAO,cAAc,CACrB,MAAO,CAAAC,SAAS,KAAM,mBAAmB,CACzC,MAAO,CAAAC,UAAU,KAAM,oCAAoC,CAC3D,MAAO,cAAc,CACrB,OAIEC,kBAAkB,KAEb,iBAAiB,CACxB,MAAO,CAAAC,YAAY,EAAIC,MAAM,KAAQ,4BAA4B,CACjE,OAASC,GAAG,CAAEC,IAAI,CAAEC,MAAM,CAAEC,WAAW,KAAQ,UAAU,CACzD,MAAO,CAAAC,SAAS,EAAIC,YAAY,KAAkB,sBAAsB,CACxE,MAAO,CAAAC,gBAAgB,KAAM,wCAAwC,CACrE,MAAO,CAAAC,mBAAmB,KAAM,uBAAuB,CACvD,MAAO,CAAAC,WAAW,KAAM,4BAA4B,CACpD,MAAO,CAAAC,uBAAuB,KAAM,uCAAuC,CAC3E,OACEC,6BAA6B,CAC7BC,iBAAiB,CACjBC,mBAAmB,KACd,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAehB;AACA,GAAM,CAAAC,qBAAkD,CAAG,CACzDC,IAAI,CAAE,OAAO,CACbC,IAAI,CAAE,OAAO,CACbC,EAAE,CAAE,QAAQ,CACZC,KAAK,CAAE,YAAc;AACvB,CAAC,CAED,QAAS,CAAAC,iBAAiBA,CAACC,SAAiB,CAAY,CACtD,GAAIA,SAAS,GAAI,CAAAN,qBAAqB,CAAE,CACtC,MAAO,CAAAA,qBAAqB,CAACM,SAAS,CAAC,CACzC,CACA,MAAO,CAAAA,SAAS,CAClB,CAEA,QAAS,CAAAC,MAAMA,CAAAC,IAAA,CAKC,IAJd,CAAAC,IAAI,CAAAD,IAAA,CAAJC,IAAI,CACJC,WAAW,CAAAF,IAAA,CAAXE,WAAW,CACXC,eAAe,CAAAH,IAAA,CAAfG,eAAe,CACfC,UAAU,CAAAJ,IAAA,CAAVI,UAAU,CAEV,IAAAC,WAAA,CAA0CzC,UAAU,CAACkB,uBAAuB,CAAC,CAArEwB,gBAAgB,CAAAD,WAAA,CAAhBC,gBAAgB,CAAEC,WAAW,CAAAF,WAAA,CAAXE,WAAW,CACrC,IAAAC,YAAA,CAAkB5C,UAAU,CAACO,YAAY,CAAC,CAAlCsC,KAAK,CAAAD,YAAA,CAALC,KAAK,CACb,IAAAC,iBAAA,CAKI/B,gBAAgB,EAAE,CAJpBgC,aAAa,CAAAD,iBAAA,CAAbC,aAAa,CACbC,kBAAkB,CAAAF,iBAAA,CAAlBE,kBAAkB,CAClBC,gBAAgB,CAAAH,iBAAA,CAAhBG,gBAAgB,CAChBC,cAAc,CAAAJ,iBAAA,CAAdI,cAAc,CAGhB;AACA,IAAAC,SAAA,CAAgDlD,QAAQ,CAAoB,CAC1EmD,UAAU,CAAE,KAAK,CACjBC,IAAI,CAAE,CAAC,CAAC,CACRC,IAAI,CAAE,CAAC,CACT,CAAC,CAAC,CAAAC,UAAA,CAAAC,cAAA,CAAAL,SAAA,IAJKM,gBAAgB,CAAAF,UAAA,IAAEG,mBAAmB,CAAAH,UAAA,IAM5C,GAAM,CAAAI,qBAAqB,CAAG,QAAxB,CAAAA,qBAAqBA,CAAA,CAAS,CAClCC,gBAAgB,EAAE,CAClBZ,kBAAkB,EAAE,CACtB,CAAC,CAED7C,SAAS,CAAC,UAAM,KAAA0D,gBAAA,CACdF,qBAAqB,EAAE,CACvBhB,WAAW,EAAE,CACb,CAAAkB,gBAAA,CAAAC,OAAO,CAACC,OAAO,UAAAF,gBAAA,iBAAfA,gBAAA,CAAiBG,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,CAC/B,CAAC,CAAE,CAAC3B,IAAI,CAAC4B,EAAE,CAAC,CAAC,CAEb9D,SAAS,CAAC,UAAM,CACd,GAAIuC,gBAAgB,CAAE,CACpBwB,iBAAiB,EAAE,CACnBP,qBAAqB,EAAE,CACzB,CACF,CAAC,CAAE,CAACjB,gBAAgB,CAAC,CAAC,CAEtB,GAAM,CAAAkB,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAA,CAAS,CAC7BF,mBAAmB,CAAC,SAACS,KAAK,CAAK,CAC7B,OAAAC,aAAA,CAAAA,aAAA,IACKD,KAAK,MACRf,UAAU,CAAE,KAAK,GAErB,CAAC,CAAC,CACJ,CAAC,CAED,GAAM,CAAAiB,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIC,OAAmB,CAAK,CAC7C,GAAI9B,UAAU,GAAK+B,SAAS,CAAE,CAC5B/B,UAAU,CAAC8B,OAAO,CAAC,CACrB,CACAX,qBAAqB,EAAE,CACzB,CAAC,CAED,GAAM,CAAAG,OAAO,CAAG5D,MAAM,CAAwB,IAAI,CAAC,CAEnD,GAAM,CAAAgE,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAAA,CAAS,KAAAM,iBAAA,CAC9B,GAAM,CAAAC,SAAS,CAAGC,QAAQ,CAACC,cAAc,IAAAC,MAAA,CACpClC,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAE4B,OAAO,CAACO,UAAU,aACxC,CACD,GAAM,CAAAC,OAAO,CAAGJ,QAAQ,CAACC,cAAc,IAAAC,MAAA,CAClClC,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAE4B,OAAO,CAACS,QAAQ,aACtC,CAED,GAAM,CAAAC,WAAW,CAAG5D,iBAAiB,CAACqD,SAAS,CAAgB,CAC/D,GAAM,CAAAQ,UAAU,CAAG7D,iBAAiB,CAAC0C,OAAO,CAACC,OAAO,CAAgB,CAEpE,GAAM,CAAAmB,eAAe,CAAG7D,mBAAmB,CACzC2D,WAAW,CACX5D,iBAAiB,CAAC0D,OAAO,CAAgB,CAC1C,CAED,GAAM,CAAAK,eAAe,CAAGhE,6BAA6B,CACnD8D,UAAU,CACVC,eAAe,CACfF,WAAW,CAACI,MAAM,CACnB,CACD,CAAAZ,iBAAA,CAAAV,OAAO,CAACC,OAAO,UAAAS,iBAAA,iBAAfA,iBAAA,CAAiBa,QAAQ,CAACF,eAAe,CAAC,CAC5C,CAAC,CAED,GAAM,CAAAG,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAIC,UAAkB,CAAK,CAC9C,MACE,CAAA7C,gBAAgB,EAChBA,gBAAgB,CAAC4B,OAAO,CAACO,UAAU,EAAIU,UAAU,EACjDA,UAAU,EAAI7C,gBAAgB,CAAC4B,OAAO,CAACS,QAAQ,CAEnD,CAAC,CAED,GAAM,CAAAS,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,WAAmB,CAAEC,SAAiB,CAAK,CACrE,GAAM,CAAAjB,SAAS,CAAGC,QAAQ,CAACC,cAAc,IAAAC,MAAA,CAAIa,WAAW,aAAW,CACnE,GAAM,CAAAX,OAAO,CAAGJ,QAAQ,CAACC,cAAc,IAAAC,MAAA,CAAIc,SAAS,aAAW,CAE/D,MAAO,CAAArE,mBAAmB,CACxBD,iBAAiB,CAACqD,SAAS,CAAgB,CAC3CrD,iBAAiB,CAAC0D,OAAO,CAAgB,CAC1C,CACH,CAAC,CAED,GAAM,CAAAa,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAA,CAAS,CAC5B,MAAO,CAAArD,WAAW,CAACsD,GAAG,CAAC,SAACtB,OAAO,CAAK,CAClC,GAAQ,CAAAL,EAAE,CAAiCK,OAAO,CAA1CL,EAAE,CAAEc,QAAQ,CAAuBT,OAAO,CAAtCS,QAAQ,CAAEF,UAAU,CAAWP,OAAO,CAA5BO,UAAU,CAAEgB,IAAI,CAAKvB,OAAO,CAAhBuB,IAAI,CACtC,GAAM,CAAAC,GAAG,CAAGN,kBAAkB,CAACX,UAAU,CAAEE,QAAQ,CAAC,CACpD,MAAO,CACLT,OAAO,CAAPA,OAAO,CACPL,EAAE,CAAFA,EAAE,CACF6B,GAAG,CAAHA,GAAG,CACHC,KAAK,CAAEzF,kBAAkB,CAACuF,IAAI,CAChC,CAAC,CACH,CAAC,CAAC,CACJ,CAAC,CAED,mBACEpE,KAAA,QACEuE,SAAS,CAAC,gBAAgB,CAC1BC,OAAO,CAAE,SAAAA,QAAA,CAAM,CACbrC,gBAAgB,EAAE,CAClB,GAAIlB,gBAAgB,CAAE,CACpBC,WAAW,EAAE,CACf,CACF,CAAE,CAAAuD,QAAA,eAEF3E,IAAA,QACEyE,SAAS,CAAC,qBAAqB,CAC/BC,OAAO,CAAE,SAAAA,QAACE,KAAuB,CAAK,CACpCA,KAAK,CAACC,eAAe,EAAE,CACvBC,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC,CAC9C,CAAE,CACFC,KAAK,CAAE,CAAEC,GAAG,CAAE/C,gBAAgB,CAACH,IAAI,CAAEmD,IAAI,CAAEhD,gBAAgB,CAACJ,IAAK,CAAE,CAAA6C,QAAA,cAEnE3E,IAAA,CAACP,mBAAmB,EAClB0F,IAAI,CAAEjD,gBAAgB,CAACL,UAAW,CAClCuD,QAAQ,CAAEhD,qBAAsB,CAChCiD,QAAQ,CAAEvC,aAAc,CACxBwC,KAAK,CAAE9D,aAAuB,EAC9B,EACE,cACNxB,IAAA,CAACV,SAAS,CAAAuD,aAAA,CAAAA,aAAA,IACJtD,YAAY,MAChB+B,KAAK,CAAErC,MAAM,CAACqC,KAAK,CAAC,CAAGzC,SAAS,CAAGC,UAAW,CAC9CgC,IAAI,CAAEA,IAAI,CAACyE,OAAQ,CACnBC,QAAQ,CAAE9E,iBAAiB,CAACI,IAAI,CAAC2E,cAAc,CAAE,CAAAd,QAAA,CAEhD,SAAAA,SAAAe,KAAA,CAA+D,IAA5D,CAAAjB,SAAS,CAAAiB,KAAA,CAATjB,SAAS,CAAEO,KAAK,CAAAU,KAAA,CAALV,KAAK,CAAEW,MAAM,CAAAD,KAAA,CAANC,MAAM,CAAEC,YAAY,CAAAF,KAAA,CAAZE,YAAY,CAAEC,aAAa,CAAAH,KAAA,CAAbG,aAAa,CACvD,mBACE7F,IAAA,CAAAI,SAAA,EAAAuE,QAAA,cACEzE,KAAA,CAAChB,GAAG,EAAC4G,GAAG,CAAEvD,OAAQ,CAAAoC,QAAA,EACfP,eAAe,EAAE,CAACC,GAAG,CAAC,SAACzB,KAAK,CAAK,CAChC,mBACE5C,IAAA,CAACN,WAAW,EAEV8E,KAAK,CAAE5B,KAAK,CAAC4B,KAAM,CACnBuB,IAAI,CAAEnD,KAAK,CAAC2B,GAAI,CAChByB,KAAK,CAAE,EAAG,CACVC,QAAQ,CAAE,SAAAA,SAAA,CAAM,CACd;AACA;AACAjF,eAAe,CAAC4B,KAAK,CAACG,OAAO,CAACL,EAAE,CAAC,CACnC,CAAE,EARGE,KAAK,CAACF,EAAE,CASb,CAEN,CAAC,CAAC,CACDiD,MAAM,CAACtB,GAAG,CAAC,SAAC6B,IAAI,CAAEC,SAAS,CAAK,CAC/B,GAAI,CAAAC,gBAAgB,CACpB,GAAIzE,cAAc,CAACwE,SAAS,CAAC,CAAE,CAC7BC,gBAAgB,CAAG,eAAe,CACpC,CACA,GAAIrC,eAAe,CAACoC,SAAS,CAAC,CAAE,CAC9BC,gBAAgB,CAAG,0BAA0B,CAC/C,CAEA,mBACElG,KAAA,CAACf,IAAI,CAAA0D,aAAA,CAAAA,aAAA,IAEC+C,YAAY,CAAC,CAAEM,IAAI,CAAJA,IAAI,CAAEG,GAAG,CAAEF,SAAU,CAAC,CAAC,MAAAxB,QAAA,eAE1C3E,IAAA,CAACZ,MAAM,EACLsF,OAAO,CAAE,SAAAA,QAAC4B,CAAC,CAAK,CACd5E,gBAAgB,CAAC4E,CAAC,CAAEH,SAAS,CAAC,CAChC,CAAE,CAAAxB,QAAA,CAEDwB,SAAS,CAAG,CAAC,EACP,cACTnG,IAAA,CAACX,WAAW,EACVqD,EAAE,IAAAW,MAAA,CAAK8C,SAAS,YAAW,CAC3B1B,SAAS,CAAE2B,gBAAiB,CAC5BG,aAAa,CAAE,SAAAA,cAAC3B,KAAuB,CAAK,CAC1C,GAAIjD,cAAc,CAACwE,SAAS,CAAC,CAAE,CAC7BvB,KAAK,CAAC4B,cAAc,EAAE,CACtBrE,mBAAmB,CAAC,CAClBN,UAAU,CAAE,IAAI,CAChBC,IAAI,CAAE8C,KAAK,CAAC6B,KAAK,CACjB1E,IAAI,CAAE6C,KAAK,CAAC8B,KACd,CAAC,CAAC,CACJ,CACF,CAAE,CAAA/B,QAAA,CAEDuB,IAAI,CAAC7B,GAAG,CAAC,SAACsC,KAAK,CAAEC,UAAU,qBAC1B5G,IAAA,QAAA6C,aAAA,IAEMgD,aAAa,CAAC,CAAEc,KAAK,CAALA,KAAK,CAAEN,GAAG,CAAEO,UAAW,CAAC,CAAC,EADxCA,UAAU,CAEf,EACH,CAAC,EACU,IA9BTT,SAAS,CA+BT,CAEX,CAAC,CAAC,GACE,EACL,CAEP,CAAC,GACS,GACR,CAEV,CAEA,cAAe,CAAAvF,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}