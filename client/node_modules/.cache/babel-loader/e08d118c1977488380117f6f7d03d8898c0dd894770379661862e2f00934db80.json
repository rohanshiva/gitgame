{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/runner/work/gitgame/gitgame/client/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import{AckNewCommentAction,CommentsAction,LobbyAction,NewCommentAction,SourceCodeAction}from\"../actions/GameActions\";import{ResponseType,GameStateDispatchEventType}from\"../../../Interface\";function getNewStateFromWSResponse(state,payload){switch(payload.message_type){case ResponseType.LOBBY:return LobbyAction(state,payload);case ResponseType.SOURCE_CODE:return SourceCodeAction(state,payload);case ResponseType.COMMENTS:return CommentsAction(state,payload);case ResponseType.NEW_COMMENT:return NewCommentAction(state,payload);default:return state;}}function reduceWsResponse(state,payload){var messages=[payload];if(payload.message_type===ResponseType.BATCH){messages=payload.messages;}var newState=state;var _iterator=_createForOfIteratorHelper(messages),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var message=_step.value;newState=getNewStateFromWSResponse(newState,message);}}catch(err){_iterator.e(err);}finally{_iterator.f();}return newState;}export default function gameReducer(state,event){switch(event.event_type){case GameStateDispatchEventType.WS_RESPONSE:return reduceWsResponse(state,event);case GameStateDispatchEventType.ACK_NEW_COMMENT:return AckNewCommentAction(state,event.comment_id);}}","map":{"version":3,"names":["AckNewCommentAction","CommentsAction","LobbyAction","NewCommentAction","SourceCodeAction","ResponseType","GameStateDispatchEventType","getNewStateFromWSResponse","state","payload","message_type","LOBBY","SOURCE_CODE","COMMENTS","NEW_COMMENT","reduceWsResponse","messages","BATCH","newState","_iterator","_createForOfIteratorHelper","_step","s","n","done","message","value","err","e","f","gameReducer","event","event_type","WS_RESPONSE","ACK_NEW_COMMENT","comment_id"],"sources":["/home/runner/work/gitgame/gitgame/client/src/components/game/reducers/GameReducer.tsx"],"sourcesContent":["import {\n  AckNewCommentAction,\n  CommentsAction,\n  LobbyAction,\n  NewCommentAction,\n  SourceCodeAction,\n} from \"../actions/GameActions\";\nimport {\n  GameState,\n  LobbyPayload,\n  ResponsePayload,\n  ResponseType,\n  SourceCodePayload,\n  CommentsPayload,\n  BatchPayload,\n  NewCommentPayload,\n  GameStateDispatchEvent,\n  GameStateDispatchEventType,\n  AckNewComment,\n} from \"../../../Interface\";\n\nfunction getNewStateFromWSResponse(state: GameState, payload: ResponsePayload) {\n  switch (payload.message_type) {\n    case ResponseType.LOBBY:\n      return LobbyAction(state, payload as LobbyPayload);\n    case ResponseType.SOURCE_CODE:\n      return SourceCodeAction(state, payload as SourceCodePayload);\n    case ResponseType.COMMENTS:\n      return CommentsAction(state, payload as CommentsPayload);\n    case ResponseType.NEW_COMMENT:\n      return NewCommentAction(state, payload as NewCommentPayload);\n    default:\n      return state;\n  }\n}\n\nfunction reduceWsResponse(state: GameState, payload: ResponsePayload) {\n  let messages = [payload];\n  if (payload.message_type === ResponseType.BATCH) {\n    messages = (payload as BatchPayload).messages;\n  }\n  let newState = state;\n  for (const message of messages) {\n    newState = getNewStateFromWSResponse(newState, message);\n  }\n  return newState;\n}\n\nexport default function gameReducer(\n  state: GameState,\n  event: GameStateDispatchEvent\n) {\n  switch (event.event_type) {\n    case GameStateDispatchEventType.WS_RESPONSE:\n      return reduceWsResponse(state, event as ResponsePayload);\n    case GameStateDispatchEventType.ACK_NEW_COMMENT:\n      return AckNewCommentAction(state, (event as AckNewComment).comment_id);\n  }\n}\n"],"mappings":"sJAAA,OACEA,mBAAmB,CACnBC,cAAc,CACdC,WAAW,CACXC,gBAAgB,CAChBC,gBAAgB,KACX,wBAAwB,CAC/B,OAIEC,YAAY,CAMZC,0BAA0B,KAErB,oBAAoB,CAE3B,QAAS,CAAAC,yBAAyBA,CAACC,KAAgB,CAAEC,OAAwB,CAAE,CAC7E,OAAQA,OAAO,CAACC,YAAY,EAC1B,IAAK,CAAAL,YAAY,CAACM,KAAK,CACrB,MAAO,CAAAT,WAAW,CAACM,KAAK,CAAEC,OAAO,CAAiB,CACpD,IAAK,CAAAJ,YAAY,CAACO,WAAW,CAC3B,MAAO,CAAAR,gBAAgB,CAACI,KAAK,CAAEC,OAAO,CAAsB,CAC9D,IAAK,CAAAJ,YAAY,CAACQ,QAAQ,CACxB,MAAO,CAAAZ,cAAc,CAACO,KAAK,CAAEC,OAAO,CAAoB,CAC1D,IAAK,CAAAJ,YAAY,CAACS,WAAW,CAC3B,MAAO,CAAAX,gBAAgB,CAACK,KAAK,CAAEC,OAAO,CAAsB,CAC9D,QACE,MAAO,CAAAD,KAAK,CAAC,CAEnB,CAEA,QAAS,CAAAO,gBAAgBA,CAACP,KAAgB,CAAEC,OAAwB,CAAE,CACpE,GAAI,CAAAO,QAAQ,CAAG,CAACP,OAAO,CAAC,CACxB,GAAIA,OAAO,CAACC,YAAY,GAAKL,YAAY,CAACY,KAAK,CAAE,CAC/CD,QAAQ,CAAIP,OAAO,CAAkBO,QAAQ,CAC/C,CACA,GAAI,CAAAE,QAAQ,CAAGV,KAAK,CAAC,IAAAW,SAAA,CAAAC,0BAAA,CACCJ,QAAQ,EAAAK,KAAA,KAA9B,IAAAF,SAAA,CAAAG,CAAA,KAAAD,KAAA,CAAAF,SAAA,CAAAI,CAAA,IAAAC,IAAA,EAAgC,IAArB,CAAAC,OAAO,CAAAJ,KAAA,CAAAK,KAAA,CAChBR,QAAQ,CAAGX,yBAAyB,CAACW,QAAQ,CAAEO,OAAO,CAAC,CACzD,CAAC,OAAAE,GAAA,EAAAR,SAAA,CAAAS,CAAA,CAAAD,GAAA,WAAAR,SAAA,CAAAU,CAAA,IACD,MAAO,CAAAX,QAAQ,CACjB,CAEA,cAAe,SAAS,CAAAY,WAAWA,CACjCtB,KAAgB,CAChBuB,KAA6B,CAC7B,CACA,OAAQA,KAAK,CAACC,UAAU,EACtB,IAAK,CAAA1B,0BAA0B,CAAC2B,WAAW,CACzC,MAAO,CAAAlB,gBAAgB,CAACP,KAAK,CAAEuB,KAAK,CAAoB,CAC1D,IAAK,CAAAzB,0BAA0B,CAAC4B,eAAe,CAC7C,MAAO,CAAAlC,mBAAmB,CAACQ,KAAK,CAAGuB,KAAK,CAAmBI,UAAU,CAAC,CAAC,CAE7E"},"metadata":{},"sourceType":"module","externalDependencies":[]}